# Worker Pool

Этот проект реализует примитивный worker pool (пул воркеров) на языке Go. Worker pool поддерживает динамическое добавление и удаление воркеров, а также обработку задач в многопоточной среде с использованием горутин и каналов. Проект был выполнен как тестовое задание для стажировки в ВКонтакте на позицию "Backend Developer".

## Описание

Worker pool позволяет управлять воркерами для обработки задач, поступающих в канал. Каждая задача представляет собой строку, которую воркеры обрабатывают, выводя в консоль информацию о номере воркера и данных задачи. Основные функции:

- **Динамическое добавление и удаление воркеров**: количество воркеров может изменяться по требованию.
- **Обработка задач воркерами**: задачи добавляются в канал, и каждый воркер получает задачу для выполнения, обрабатывая её параллельно с другими воркерами.
- **Контроль работы пула**: пул поддерживает управление задачами и воркерами через команды из консоли.

## Структура проекта

Проект состоит из нескольких файлов:

- `main.go`: основной файл, который запускает worker pool и позволяет управлять им через консольные команды.
- `workerpool/task.go`: файл, содержащий определение структуры задачи и методы её обработки.
- `workerpool/worker.go`: файл с определением структуры воркера и его методами.
- `workerpool/pool.go`: файл с реализацией пула воркеров и функциями для управления воркерами и задачами.
- `workerpool/pool_test.go`: файл с тестами, проверяющими корректность работы worker pool.

## Установка и запуск

1. Клонируйте репозиторий и перейдите в его директорию:
   ```bash
   git clone <URL_REPOSITORY>
   cd <REPOSITORY_NAME>
   ```

2. Убедитесь, что установлен Go версии 1.17 или выше. Установите необходимые зависимости и выполните сборку:
   ```bash
   go mod tidy
   go build
   ```

## Запуск программы

Для запуска worker pool выполните команду:

```bash
go run main.go
```

После запуска вы сможете управлять worker pool с помощью следующих команд:

- `add_task <data>` — добавляет задачу с указанными данными `<data>`. Например:
  ```bash
  add_task HelloWorld
  ```
- `add_worker` — добавляет нового воркера в пул.
- `remove_worker` — удаляет последнего добавленного воркера из пула.
- `stop` — останавливает всех воркеров и завершает выполнение программы.

Пример работы:

```
$ go run main.go
Enter commands: add_task <data>, add_worker, remove_worker, stop
add_task HelloWorld
add_worker
remove_worker
stop
```

## Запуск тестов

Для запуска тестов убедитесь, что находитесь в корневой директории проекта и выполните команду:

```bash
go test ./workerpool
```

Тесты проверяют корректность добавления и удаления воркеров, остановки пула и обработки задач при высокой нагрузке.

## Примечания

- **Добавление задач после остановки пула**: При попытке добавить задачу в канал после остановки пула программа вызовет `panic`, так как канал задач закрыт. Этот аспект учтён в тестах для подтверждения корректности поведения.
- **Буферизованный канал**: Канал задач буферизован (с размером, указанным при создании пула), что предотвращает блокировку добавления задач в канал, если воркеры временно заняты.